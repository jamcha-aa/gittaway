<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>04 - 陽気な仲間 | とらとらTravis</title>
    <meta name="description" content="黒い画面を使うとしぬ呪いをかけられてしまったら。">
    <link rel="icon" type="image/png" href="/travisci/img/favicon.png">
    
    <link rel="preload" href="/travisci/assets/css/0.styles.3e203cda.css" as="style"><link rel="preload" href="/travisci/assets/js/app.7c73ba0b.js" as="script"><link rel="preload" href="/travisci/assets/js/2.5833917c.js" as="script"><link rel="preload" href="/travisci/assets/js/3.40cefd50.js" as="script"><link rel="prefetch" href="/travisci/assets/js/10.b6cf2e9b.js"><link rel="prefetch" href="/travisci/assets/js/11.5d2a6e9f.js"><link rel="prefetch" href="/travisci/assets/js/4.7c2a84c4.js"><link rel="prefetch" href="/travisci/assets/js/5.4f26e240.js"><link rel="prefetch" href="/travisci/assets/js/6.5668b12b.js"><link rel="prefetch" href="/travisci/assets/js/7.42666c55.js"><link rel="prefetch" href="/travisci/assets/js/8.2ea9cd76.js"><link rel="prefetch" href="/travisci/assets/js/9.e5d1c816.js">
    <link rel="stylesheet" href="/travisci/assets/css/0.styles.3e203cda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/travisci/" class="home-link router-link-active"><!----> <span class="site-name">とらとらTravis</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/travisci/" class="nav-link">ホーム</a></div><div class="nav-item"><a href="https://jamcha-aa.github.io/About/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  作品一覧
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jamcha-aa/travisci/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/travisci/" class="nav-link">ホーム</a></div><div class="nav-item"><a href="https://jamcha-aa.github.io/About/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  作品一覧
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jamcha-aa/travisci/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>目次</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/travisci/article/01 - あの黒い画面恐怖症.html" class="sidebar-link">01 - あの黒い画面恐怖症</a></li><li><a href="/travisci/article/02 - YAML語の住人.html" class="sidebar-link">02 - YAML語の住人</a></li><li><a href="/travisci/article/03 - 目覚めとおまけ Nextcloud Notes.html" class="sidebar-link">03 - 目覚めとおまけ: Nextcloud Notes</a></li><li><a href="/travisci/article/04 - 陽気な仲間.html" class="active sidebar-link">04 - 陽気な仲間</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/travisci/article/04 - 陽気な仲間.html#下準備" class="sidebar-link">下準備</a></li><li class="sidebar-sub-header"><a href="/travisci/article/04 - 陽気な仲間.html#githubトークン" class="sidebar-link">GitHubトークン</a></li><li class="sidebar-sub-header"><a href="/travisci/article/04 - 陽気な仲間.html#travisおじさん、起動" class="sidebar-link">Travisおじさん、起動</a></li><li class="sidebar-sub-header"><a href="/travisci/article/04 - 陽気な仲間.html#travisおじさん、指示どおりに-master-ブランチを灰燼に帰す" class="sidebar-link">Travisおじさん、指示どおりに master ブランチを灰燼に帰す</a></li><li class="sidebar-sub-header"><a href="/travisci/article/04 - 陽気な仲間.html#travis-yml-を修正" class="sidebar-link">.travis.yml を修正</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="_04-陽気な仲間"><a href="#_04-陽気な仲間" aria-hidden="true" class="header-anchor">#</a> 04 - 陽気な仲間</h1> <p>「CI (継続的インテグレーション) って開発手法を指すらしいんだけど、とりあえずここではCIを補助するサービスの話をします」<br>
『ああ』<br>
「パソコンで作業してるといずれ『あの黒い画面』を触るときが来ると思う。でもたいていの人は汚物を見るように避けるか、どうしてもやらなきゃいけないときはお金を払うか誰かの家族を人質にしてやらせてると思う」<br>
『殺伐としすぎだろ…』<br>
「したがって『あの黒い画面』を触らずに済む方法が必要で、その解決策のひとつとして私はCIサービスを提案します」<br>
『ほー』<br>
「CIサービスはどこまで『あの黒い画面』を肩代わりしてくれるのか、それを確かめたかったので、今回はこの作品を『あの黒い画面』を一切触らずに作ってみようと思いました」</p> <ul><li><p><code>.travis.yml</code> と <code>package.json</code> の引用元:</p> <ul><li><a href="https://itnext.io/publish-a-vuepress-site-on-github-pages-with-travis-82036243bf36" target="_blank" rel="noopener noreferrer">Publish a Vuepress site on GitHub pages with Travis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><p>参考にしたページ:</p> <ul><li><a href="https://qiita.com/uphy/items/26ea2862b75c6c6e703d" target="_blank" rel="noopener noreferrer">VuePressでGitHub Pagesにリッチなドキュメントを作る<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://alvinmi.github.io/2019/03/22/Github+Vuepress+Travis-CI%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90.html" target="_blank" rel="noopener noreferrer">Github + Vuepress + Travis-CI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h2 id="下準備"><a href="#下準備" aria-hidden="true" class="header-anchor">#</a> 下準備</h2> <p>「今回は『あの黒い画面』での作業を <a href="https://travis-ci.org/" target="_blank" rel="noopener noreferrer">Travis CI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> にお願いしました。理由はTravisおじさんがプリングルズみたいなものすごいひげで、あともう一人いるんだけどその人の唇が寒中水泳の…」<br>
『マスコットのインパクトにやられたんだな。まったく君は、 <a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer">Docusaurus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> の恐竜といい、そういう…』<br>
「恐竜じゃなくて 『<a href="https://docusaurus.io/en/about-slash" target="_blank" rel="noopener noreferrer">Slash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>』 だよ、『Slash』。君さ、失礼じゃない？友達とか家族のこと『人間』なんて呼ぶ？呼ばないでしょ？」<br>
『…』「Slash。聞こえた？」<br>
『ああ。…(ひげをからかうのは失礼じゃないのか？)』<br>
「からかってるんじゃなくてひげがすごいって言ってるだけなんだけど！？」『あ、ああ。そうだな…何か、からかうより失礼だと思うんだが…』</p> <br> <p>「基本的なファイル構成はふだん私が使っているテンプレートから引っ張ってきて、 <code>.travis.yml</code> と <code>package.json</code> だけ追加した感じ」</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>user@manjaro-arm travisci<span class="token punctuation">]</span>$ tree -al -I <span class="token string">&quot;.git&quot;</span>
<span class="token keyword">.</span>
├── .gitignore
├── .nojekyll
├── .travis.yml
├── .vuepress
│   ├── config.js
│   ├── public
│   │   ├── hero.png
│   │   └── img
│   │       └── favicon.png
│   ├── styles
│   │   └── palette.styl
│   └── summary.js
├── README.md
├── article
│   ├── 01.md
│   └── 01.org
└── package.json
</code></pre></div><p>「 <code>package.json</code> は引用元そのままで、」</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;docs:dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vuepress dev docs&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;docs:build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vuepress build docs&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>「 <code>.travis.yml</code> は私の環境にあわせてちょっといじった」</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;10&quot;</span>
<span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> CXX=g++<span class="token punctuation">-</span><span class="token number">4.8</span>

<span class="token key atrule">addons</span><span class="token punctuation">:</span>
    <span class="token key atrule">apt</span><span class="token punctuation">:</span>
        <span class="token key atrule">sources</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> ubuntu<span class="token punctuation">-</span>toolchain<span class="token punctuation">-</span>r<span class="token punctuation">-</span>test
        <span class="token key atrule">packages</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> g++<span class="token punctuation">-</span><span class="token number">4.8</span>
<span class="token key atrule">install</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> npm install <span class="token punctuation">-</span>g vuepress@next
<span class="token key atrule">script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> npm run docs<span class="token punctuation">:</span>build
<span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">directories</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token string">&quot;node_modules&quot;</span>
<span class="token key atrule">notifications</span><span class="token punctuation">:</span>
    <span class="token key atrule">email</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">provider</span><span class="token punctuation">:</span> pages
    <span class="token key atrule">skip-cleanup</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">local_dir</span><span class="token punctuation">:</span> /.vuepress/dist
    <span class="token key atrule">github-token</span><span class="token punctuation">:</span> $GITHUB_TOKEN  <span class="token comment"># Set in the settings page of your repository, as a secure variable</span>
    <span class="token key atrule">repo</span><span class="token punctuation">:</span> jamcha<span class="token punctuation">-</span>aa/travisci
    <span class="token key atrule">keep-history</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">target-branch</span><span class="token punctuation">:</span> master
    <span class="token key atrule">on</span><span class="token punctuation">:</span>
        <span class="token key atrule">branch</span><span class="token punctuation">:</span> master
</code></pre></div><h2 id="githubトークン"><a href="#githubトークン" aria-hidden="true" class="header-anchor">#</a> GitHubトークン</h2> <p>「それじゃあ早速動かしてみようか」『もう動かせるのか』「あと少しね。 <a href="https://travis-ci.com/" target="_blank" rel="noopener noreferrer">Travis CI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> にGitHubアカウントでログインすると、リポジトリの一覧が表示されます。リポジトリ名の隣にあるスイッチを切り替えて、Settingsをクリックすると下のあたりに『トークン取ってこい』と書かれているので取りに行く」</p> <p><img src="data:image/png;base64,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" alt="travis-toggle"></p> <p>「GitHubアカウントのSettingを選んで一番下にある <code>Developer settings</code> を選択」</p> <p><img src="/travisci/assets/img/account-settings.ca1cf754.png" alt="account-settings"></p> <p>「 <code>Personal access tokens</code> → <code>Generate new tokens</code> を選択」</p> <p><img src="/travisci/assets/img/developer-settings.d73fce3f.png" alt="developer-settings"></p> <p>「トークンの名前と権限を決める。下の画像は一旦作ったあとにスクリーンショット撮ってるから警告画面が出てるけど、初めて作るときには出ない。Travisおじさんの権限は <code>repo_deployment</code> と <code>public_repo</code> くらいでいいかな」</p> <p><img src="/travisci/assets/img/generate-tokens.d767876d.png" alt="generate-tokens"></p> <p>「準備ができたら <code>Generate token</code> をクリックする。トークンが発行されるから、この文字列をTravisのSettings画面にある <code>Environment Variables</code> のパスワード欄にコピペする。 変数名は <code>GITHUB_TOKEN</code> で、それが済んだら <code>Add</code> をクリック。…あ！大事なこと忘れてた！」<br>
『ん？』<br>
「発行画面にも英語で書かれてるけど <strong>トークンは一度しか表示されない</strong> 」<br>
『一度だけか？』　　
「そう。タブを閉じたらGitHubの設定画面を開いても再表示されない。それくらい漏れたら危険なもの。ペーストしたらすぐクリップボードの履歴も消しましょう」</p> <p><img src="/travisci/assets/img/paste-token.1c21b391.png" alt="paste-token"></p> <p>備考: <a href="https://efcl.info/2017/05/09/travis-ci-github-token/" target="_blank" rel="noopener noreferrer">Travis CIでGitHub Personal access tokensが漏れないようにする<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="travisおじさん、起動"><a href="#travisおじさん、起動" aria-hidden="true" class="header-anchor">#</a> Travisおじさん、起動</h2> <p><img src="/travisci/assets/img/travis-launched.667fe717.png" alt="travis-launched"></p> <p>「ウオオオオオオオオオオオオオオオオオ！！」</p> <p>『な、何だ突然！？』</p> <p><img src="/travisci/assets/img/travis-progress.c48150d4.png" alt="travis-progress"></p> <p>「YAML語の指示を解したTravisおじさんが仕事を開始しました。ログが流れていく様子がかっこいい。あとオープンソースプロジェクトなら、YAML語で話しかければTravisおじさんは無償のボランティアのように働いてくれます。健気すぎて涙が出てきそう」<br>
『そ、そうか…うーむ、だからって君が叫ぶ必要があるのか？それにさっきから言ってるYAML語って何だ？』<br>
「YAML語はTravisおじさん達が使う言語。 <code>.travis.yml</code> に書いてある言葉。単にYAMLとも言う」<br>
『YAML語って呼ぶ意味は？YAMLでいいだろう』<br>
「TravisおじさんはYAML語じゃないとわからない、って強く言わないと、手軽にタダで使える労働力だと勘違いするバカが出てくる」<br>
『おっと、言葉に気をつけろ。まったく、随分な言いようだな。たとえば？』<br>
「私とか」<br>
『…。うーん、どう言ったものやら…。…ほら、君が言ったとおり止まったぞ』</p> <p><img src="/travisci/assets/img/travis-stopped.a6b0089f.png" alt="travis-stopped"></p> <p>「それみたことか」<br>
『それみたことかって…YAML語とやらを書いたのは君だろ？』<br>
「そうですけど？」<br>
『開き直るのはいいから、原因は何だ』<br>
「これから調べるんですけど何か？」<br>
『…』</p> <p><img src="/travisci/assets/img/travis-log.0807a82e.png" alt="travis-log"></p> <p>『どうだ？わかりそうか？』<br>
「たぶん…、あ、ディレクトリの場所が違ってたんだ」<br>
『YAML語の文法間違いってところか』<br>
「そうそう。Travisおじさんには正しい言葉遣いじゃないと通じないからね」</p> <p><img src="/travisci/assets/img/fix-yml.1c03d691.png" alt="fix-yml"></p> <h2 id="travisおじさん、指示どおりに-master-ブランチを灰燼に帰す"><a href="#travisおじさん、指示どおりに-master-ブランチを灰燼に帰す" aria-hidden="true" class="header-anchor">#</a> Travisおじさん、指示どおりに <code>master</code> ブランチを灰燼に帰す</h2> <p><img src="/travisci/assets/img/travis-success.38c470e2.png" alt="travis-success"></p> <p>『今度は成功したようだな』<br>
「うん。…あれ？」<br>
『ん？どうした？』<br>
「 <code>master</code> ブランチの中身が全部消えてる」<br>
『へ？』</p> <p><img src="/travisci/assets/img/travis-delete.fa2719d4.png" alt="travis-delete"></p> <p>『どういうことだ？成功したんだろ？』<br>
「うん。たぶん…むしろ、ちゃんと伝わっちゃったせいで全部消されたんだと思う」<br>
『意味がわからない』<br>
「わかれよ！！」</p> <p>ドン！</p> <p>『…』<br>
「…」<br>
『…すまない。ショックだったのは君だよな』<br>
「…こっちこそごめんね。はー…」</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>    <span class="token key atrule">target-branch</span><span class="token punctuation">:</span> master
</code></pre></div><p>「あー…そうか。私のYAML語は文法的にはあってて、でも仕事の結果を <code>master</code> ブランチに上書きするものになっちゃってたのか…」<br>
『直せそうか？』<br>
「原因はわかったよ。ここをこうすれば」</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>    <span class="token key atrule">target-branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages
</code></pre></div><p>「これでTravisおじさんは私のねらいどおりに働いてくれると思う」<br>
『じゃあやってみるか』<br>
「うん。 <code>revert</code> でGitコマンドを使わなきゃいけないから、当初の目的は失敗だけど、でもファイルのアップロードは全部GitHubの画面からやってるよ」<br>
『手間じゃないのか』<br>
「そりゃあもうものすごく面倒だよ」<br>
『だろうな…』<br>
「アップロードに失敗したり、気を抜くとすぐ <code>master</code> ブランチに戻るから間違えてアップロードしちゃったりして、やっぱブラウザの画面ておまけなんだなって思い知らされました」</p> <h2 id="travis-yml-を修正"><a href="#travis-yml-を修正" aria-hidden="true" class="header-anchor">#</a> <code>.travis.yml</code> を修正</h2> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;10&quot;</span>
<span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> CXX=g++<span class="token punctuation">-</span><span class="token number">4.8</span>

<span class="token key atrule">addons</span><span class="token punctuation">:</span>
    <span class="token key atrule">apt</span><span class="token punctuation">:</span>
        <span class="token key atrule">sources</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> ubuntu<span class="token punctuation">-</span>toolchain<span class="token punctuation">-</span>r<span class="token punctuation">-</span>test
        <span class="token key atrule">packages</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> g++<span class="token punctuation">-</span><span class="token number">4.8</span>
<span class="token key atrule">install</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> npm install <span class="token punctuation">-</span>g vuepress@next
<span class="token key atrule">script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> npm run docs<span class="token punctuation">:</span>build
<span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">directories</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token string">&quot;node_modules&quot;</span>
<span class="token key atrule">notifications</span><span class="token punctuation">:</span>
    <span class="token key atrule">email</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">provider</span><span class="token punctuation">:</span> pages
    <span class="token key atrule">skip-cleanup</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">local_dir</span><span class="token punctuation">:</span> .vuepress/dist  <span class="token comment"># ビルドされたファイルが置かれる場所</span>
    <span class="token key atrule">github-token</span><span class="token punctuation">:</span> $GITHUB_TOKEN  <span class="token comment"># Set in the settings page of your repository, as a secure variable</span>
    <span class="token key atrule">repo</span><span class="token punctuation">:</span> jamcha<span class="token punctuation">-</span>aa/travisci  <span class="token comment"># リポジトリ名</span>
    <span class="token key atrule">keep-history</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">target-branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages  <span class="token comment"># 出力されるブランチ</span>
    <span class="token key atrule">on</span><span class="token punctuation">:</span>
        <span class="token key atrule">branch</span><span class="token punctuation">:</span> master  <span class="token comment"># このブランチの中身がtarget-branchに出力される</span>
</code></pre></div><p><img src="/travisci/assets/img/Tessa-pride-4.49f04b06.png" alt="Tessa">
(c) Travis CI, GmbH.</p> <p>『おわっ！』<br>
「ん？」<br>
『なんだ今のは？Travisは一人じゃないのか！？』<br>
「え、Tessaのこと？」<br>
『Travisじゃないのか』<br>
「Travisはものすごいひげの方だよ。Tessaはかわいい方。唇がまるで寒中水泳…」<br>
『いや、言いたいことはわかった』<br>
「でしょ。かわいいよね」<br>
『いや、そういうわけじゃないんだが…まあ、それはともかく、結果はどうだ？』<br>
「君が見ているこれがそうだよ」</p> <br> <br> <p>-- 了 --</p> <br> <br>  
この物語はフィクションであり，実在の人物・団体とは一切関係ありません。  
<p>(c) 2019 jamcha (jamcha.aa@gmail.com).</p> <p><img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" alt="cc by-sa"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/travisci/article/03 - 目覚めとおまけ Nextcloud Notes.html" class="prev">
          03 - 目覚めとおまけ: Nextcloud Notes
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/travisci/assets/js/app.7c73ba0b.js" defer></script><script src="/travisci/assets/js/2.5833917c.js" defer></script><script src="/travisci/assets/js/3.40cefd50.js" defer></script>
  </body>
</html>
